/******************************************************************************
*  Filename:       rf_patch_mce_tof.h
*
*  Description: RF core MCE patch for time of flight 2Mbps PHY for CC13x2 and CC26x2
*
*  Copyright (c) 2015-2019, Texas Instruments Incorporated
*  All rights reserved.
*
*  Redistribution and use in source and binary forms, with or without
*  modification, are permitted provided that the following conditions are met:
*
*  1) Redistributions of source code must retain the above copyright notice,
*     this list of conditions and the following disclaimer.
*
*  2) Redistributions in binary form must reproduce the above copyright notice,
*     this list of conditions and the following disclaimer in the documentation
*     and/or other materials provided with the distribution.
*
*  3) Neither the name of the ORGANIZATION nor the names of its contributors may
*     be used to endorse or promote products derived from this software without
*     specific prior written permission.
*
*  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
*  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
*  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
*  ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE
*  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
*  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
*  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
*  INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
*  CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
*  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
*  POSSIBILITY OF SUCH DAMAGE.
*
******************************************************************************/

#include <stdint.h>
#include "rf_patch_mce_tof.h"
#include <ti/devices/DeviceFamily.h>
#include DeviceFamily_constructPath(inc/hw_types.h)

#ifndef MCE_PATCH_TYPE
#define MCE_PATCH_TYPE static const uint32_t
#endif

#ifndef PATCH_FUN_SPEC
#define PATCH_FUN_SPEC
#endif

#ifndef RFC_MCERAM_BASE
#define RFC_MCERAM_BASE 0x21008000
#endif

#ifndef MCE_PATCH_MODE
#define MCE_PATCH_MODE 0
#endif

MCE_PATCH_TYPE patchTofMce[512] = { 
   0x00036057,
   0x00f1000f,
   0x00000000,
   0x000c8000,
   0x00000000,
   0x0c650000,
   0x80000000,
   0x00800010,
   0x00000000,
   0x05900b1e,
   0x00000000,
   0x00000000,
   0x000000ff,
   0x3737001f,
   0x0003005a,
   0x00000032,
   0xfe6b2840,
   0xdeade8ca,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x07fc0011,
   0x6fdd2fea,
   0x0ff00ff0,
   0x00030fd0,
   0x005a001f,
   0x00008010,
   0x08000340,
   0xc0304000,
   0x722367f4,
   0xa35d7263,
   0x73057303,
   0x73047203,
   0x72047306,
   0x72917391,
   0x8001c7c0,
   0x90010001,
   0x08019010,
   0x720d9001,
   0x720f720e,
   0xb0d07210,
   0xa0d07100,
   0x721bb110,
   0x10208162,
   0x06703952,
   0x16300020,
   0x14011101,
   0x608d6c01,
   0x60a96099,
   0x620e615b,
   0x608d608d,
   0x608d608d,
   0x60a96099,
   0x620e615b,
   0x608d608d,
   0x6091608d,
   0x1220608f,
   0x12126092,
   0x67eb7223,
   0x001281b1,
   0xb07091b2,
   0xc011606f,
   0xc710c2b2,
   0x6f131820,
   0x16116e23,
   0x689d1612,
   0x99907d40,
   0x8161c022,
   0x18123981,
   0x67eb6091,
   0x67a8670d,
   0x91f0c070,
   0x6727b750,
   0xb233b914,
   0xa7506742,
   0x88d4a003,
   0x88e495b4,
   0x8ca495c4,
   0x87c49594,
   0x88d495a4,
   0x88e495d4,
   0xc0f495e4,
   0x91449134,
   0xb0d0b0f6,
   0xb136b0d5,
   0xb100b110,
   0x7314b140,
   0x7ca07313,
   0x90502ad0,
   0x2a007cb0,
   0xc9609060,
   0x67c468d4,
   0x1e0ec0f1,
   0x161140da,
   0xb9129931,
   0xb041c037,
   0xc031b115,
   0x7100a910,
   0xb910b073,
   0x809073a3,
   0x45572200,
   0x226280b2,
   0x80c24505,
   0x40f82202,
   0xb061b063,
   0x87228b11,
   0x18213d82,
   0xb2349701,
   0xa1007314,
   0x40de2250,
   0x22008240,
   0x220f4502,
   0x100f40de,
   0x60de67c4,
   0x67d1100f,
   0xa91360de,
   0xb237b234,
   0xa0d5ba39,
   0xb0d1720f,
   0x7100b111,
   0xb1119937,
   0x39108c80,
   0x1a103120,
   0xb35d7100,
   0xb0749930,
   0x93f0c0d0,
   0x97918941,
   0x7100b111,
   0xba3aba3b,
   0xc210b078,
   0xa2329930,
   0xb111b235,
   0xa35d7100,
   0x7291b06e,
   0xc040a0d1,
   0x8c3367f4,
   0x14238c52,
   0x8c628c44,
   0x8b321424,
   0x8b2106f2,
   0x00123141,
   0xcff297a2,
   0x31430424,
   0x00343143,
   0xc8f097b4,
   0xb2356940,
   0x7291b914,
   0xa003a750,
   0xc7c0a002,
   0x72039010,
   0x73057204,
   0x67eb7306,
   0xb235a232,
   0x1e028242,
   0x7223454e,
   0x67f4c050,
   0xb2356091,
   0x8942a232,
   0x67eb6142,
   0x66f3c00f,
   0xc07067a8,
   0x672791f0,
   0x8c80b013,
   0x41662200,
   0x85c185b0,
   0x95e195d0,
   0xb140b100,
   0xb0d0b0f6,
   0xb111b0d5,
   0x72917313,
   0xc0e1b912,
   0x41771e0e,
   0x99311611,
   0xb041c037,
   0xc060b232,
   0xc03167f4,
   0xb115a910,
   0xb0737100,
   0x73a3b910,
   0x22008090,
   0x80b2460b,
   0x45a42262,
   0x220280c2,
   0x22504597,
   0x8240417d,
   0x45a12200,
   0x417d220f,
   0x67c4100f,
   0xb063617d,
   0x87228b11,
   0x18213d82,
   0xb2349701,
   0xa100b140,
   0x100f617d,
   0x617d67d1,
   0xb234b913,
   0xba39b237,
   0x720fa0d5,
   0x72107313,
   0xb0d17314,
   0x7100b111,
   0x9937b041,
   0x8c80b111,
   0x31203910,
   0x71001a10,
   0x9930b35d,
   0xc0d0b074,
   0xb11193f0,
   0xb0787100,
   0x9930c210,
   0xb111a232,
   0xa35d7100,
   0xa910b06e,
   0xc070a0d1,
   0x826067f4,
   0x1c018b51,
   0xc08049d2,
   0x617d67f4,
   0x67dcb1b4,
   0x14018991,
   0x140181a0,
   0xb1169931,
   0x7100b0d6,
   0xa0d6b116,
   0x22008090,
   0xb012460b,
   0x95b488d4,
   0x95c488e4,
   0x95948ca4,
   0x95a487c4,
   0x82307291,
   0x26302a20,
   0x67429230,
   0x87b1c070,
   0x31828af2,
   0xc3103d82,
   0xb06469f6,
   0xb235b111,
   0x1e028242,
   0xb91445f9,
   0xa0037291,
   0xc7c0a002,
   0x72039010,
   0x73057204,
   0xc0907306,
   0x67eb67f4,
   0xb2356091,
   0x61f97291,
   0x67a866f3,
   0xc070c00b,
   0x672791f0,
   0x727ab914,
   0x72267251,
   0x7313b013,
   0x72c97314,
   0x22008c80,
   0x62244220,
   0x85c185b0,
   0x95e195d0,
   0xb140b100,
   0xb064b110,
   0xb0d0b0f6,
   0xb136b0d5,
   0xb0617313,
   0x1e1bb041,
   0x72914234,
   0x72c9b912,
   0xc070c137,
   0x42381e0e,
   0xb2329930,
   0xb11567c4,
   0xa910c031,
   0xb0737100,
   0x73a3b910,
   0x22008090,
   0x80b246f0,
   0x46652262,
   0x220280c2,
   0xb0634258,
   0x8b11b061,
   0x3d828722,
   0x97011821,
   0xb140b234,
   0x7cd0a100,
   0x623b93a0,
   0x423b2250,
   0x22008240,
   0x220f4662,
   0x100f423b,
   0x623b67c4,
   0x67d1100f,
   0x1e1b623b,
   0xa9154281,
   0xb913b916,
   0xba3b6289,
   0x06f38b33,
   0x31448b24,
   0x97a30043,
   0x8b53b1b5,
   0x8c339513,
   0x14038c50,
   0x8c448c60,
   0x31431404,
   0x00343143,
   0x670d97b4,
   0xa91362ba,
   0xb237b234,
   0x8941b1b4,
   0x72919791,
   0x993762a6,
   0xa0d5ba39,
   0xb0d1720f,
   0xb111b111,
   0x39108c80,
   0x1a103120,
   0xb35d7100,
   0xb0749930,
   0x93f0c0d0,
   0x7100b111,
   0xc210b078,
   0xb1119930,
   0xa35d7100,
   0xa910b06e,
   0x626ba0d1,
   0x8b33ba3b,
   0x8b2406f3,
   0x00433144,
   0x8c339263,
   0x14038c50,
   0x8c448c60,
   0x31431404,
   0x00343143,
   0xc8f097b4,
   0x62d66ab8,
   0x88d4bc90,
   0x95d495b4,
   0x95c488e4,
   0x8ca495e4,
   0x87c49594,
   0xc01b95a4,
   0x73127311,
   0x73147313,
   0xb140b100,
   0xb136b0f6,
   0xb064b110,
   0x73147313,
   0x7ce067c4,
   0x623b93a0,
   0xb140b235,
   0xb136a100,
   0xb914a0f6,
   0xa7507291,
   0xa002a003,
   0x9010c7c0,
   0x72047203,
   0x73067305,
   0xa23267eb,
   0x8242b235,
   0x46e71e02,
   0xc0a07223,
   0x609167f4,
   0xa232b235,
   0x85b462d7,
   0x89839974,
   0x997485c4,
   0x14038980,
   0x1803c100,
   0x99748594,
   0x85a48982,
   0x89809974,
   0xc1001402,
   0x31121802,
   0x31833113,
   0x39823182,
   0x97220032,
   0x88d47000,
   0x89839974,
   0x997488e4,
   0x14038980,
   0x1803c100,
   0x99748ca4,
   0x87c48982,
   0x89809974,
   0xc1001402,
   0x31121802,
   0x31833113,
   0x39823182,
   0x97220032,
   0x82427000,
   0x43272212,
   0xb016b006,
   0xb002b012,
   0xb014b004,
   0x90307ca0,
   0x7cb09050,
   0x90609040,
   0xb12167eb,
   0x7100b0e1,
   0xa0e1b072,
   0x6b3dd680,
   0xc09067c4,
   0x700093f0,
   0x67f4c0b0,
   0xc080bc90,
   0xb9119930,
   0xb0d1b910,
   0x7100b111,
   0xa0d17291,
   0x7c97b111,
   0x9635722c,
   0xc0f38c82,
   0xb013b003,
   0x92c08170,
   0x96408190,
   0xb120b0e0,
   0x85b07100,
   0x92c39640,
   0x7100b120,
   0x964085c0,
   0x7100b120,
   0x96408590,
   0xb12092c3,
   0x85a07100,
   0xb1209640,
   0x6d716d71,
   0x16179cb1,
   0x1e023912,
   0x71004777,
   0x3942638a,
   0x477c1e02,
   0x637ec071,
   0xc0f11a12,
   0x8cb31020,
   0x92c17100,
   0xb1209643,
   0x6d736d73,
   0x16179cb1,
   0x6b827100,
   0x96367264,
   0x9930c040,
   0xb910b911,
   0xb111b0d1,
   0xb120a0e0,
   0x72917100,
   0xb111a0d1,
   0x1e108750,
   0xb235439d,
   0xa91563a4,
   0xb913b916,
   0x2a308230,
   0x92302620,
   0x6ba5c090,
   0x7000ac90,
   0x721b7223,
   0x92c0c0f0,
   0xc1f1722f,
   0xc01592d1,
   0x7c977c86,
   0x8c807ccc,
   0x43b72200,
   0x7d0063b9,
   0xac909440,
   0xc1009636,
   0x816e91e0,
   0xc01d398e,
   0x43c31e0e,
   0x7000c03d,
   0x726a7269,
   0xb0537cf2,
   0xc76093a2,
   0x73a36bca,
   0x96908a40,
   0x96a18a51,
   0x9a317000,
   0x8a548a43,
   0x3d633133,
   0x3d643134,
   0x96a49693,
   0x7000b053,
   0xc082c000,
   0x8c448c33,
   0x1c241834,
   0x14424fe6,
   0x63ea4be8,
   0x63ea10d0,
   0x18d0c000,
   0x720d7000,
   0x720f720e,
   0x73117210,
   0x73137312,
   0x70007314,
   0x89f09a00,
   0x47f52200,
   0x7000b9e0,
   0x00000000,
   0x56781234,
   0x59123232
};

PATCH_FUN_SPEC void rf_patch_mce_tof(void)
{
#ifdef __PATCH_NO_UNROLLING
   uint32_t i;
   for (i = 0; i < 512; i++) {
      HWREG(RFC_MCERAM_BASE + 4 * i) = patchTofMce[i];
   }
#else
   const uint32_t *pS = patchTofMce;
   volatile unsigned long *pD = &HWREG(RFC_MCERAM_BASE);
   uint32_t t1, t2, t3, t4, t5, t6, t7, t8;
   uint32_t nIterations = 64;

   do {
      t1 = *pS++;
      t2 = *pS++;
      t3 = *pS++;
      t4 = *pS++;
      t5 = *pS++;
      t6 = *pS++;
      t7 = *pS++;
      t8 = *pS++;
      *pD++ = t1;
      *pD++ = t2;
      *pD++ = t3;
      *pD++ = t4;
      *pD++ = t5;
      *pD++ = t6;
      *pD++ = t7;
      *pD++ = t8;
   } while (--nIterations);
#endif
}
