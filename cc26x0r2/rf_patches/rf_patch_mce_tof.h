/******************************************************************************
*  Filename:       rf_patch_mce_tof.h
*  Revised:        $Date: 2019-01-31 15:04:25 +0100 (to, 31 jan 2019) $
*  Revision:       $Revision: 18842 $
*
*  Description: RF core patch for supporting time-of-flight radio measurements in CC2640R2F
*
*  Copyright (c) 2015-2019, Texas Instruments Incorporated
*  All rights reserved.
*
*  Redistribution and use in source and binary forms, with or without
*  modification, are permitted provided that the following conditions are met:
*
*  1) Redistributions of source code must retain the above copyright notice,
*     this list of conditions and the following disclaimer.
*
*  2) Redistributions in binary form must reproduce the above copyright notice,
*     this list of conditions and the following disclaimer in the documentation
*     and/or other materials provided with the distribution.
*
*  3) Neither the name of the ORGANIZATION nor the names of its contributors may
*     be used to endorse or promote products derived from this software without
*     specific prior written permission.
*
*  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
*  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
*  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
*  ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE
*  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
*  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
*  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
*  INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
*  CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
*  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
*  POSSIBILITY OF SUCH DAMAGE.
*
******************************************************************************/

#ifndef _RF_PATCH_MCE_TOF_H
#define _RF_PATCH_MCE_TOF_H

#include <stdint.h>
#include "../inc/hw_types.h"

#ifndef MCE_PATCH_TYPE
#define MCE_PATCH_TYPE static const uint32_t
#endif

#ifndef PATCH_FUN_SPEC
#define PATCH_FUN_SPEC static inline
#endif

#ifndef RFC_MCERAM_BASE
#define RFC_MCERAM_BASE 0x21008000
#endif

#ifndef MCE_PATCH_MODE
#define MCE_PATCH_MODE 0
#endif

MCE_PATCH_TYPE patchTofMce[478] = { 
   0x00036055,
   0x00f1000f,
   0x00000000,
   0x000c8000,
   0x00000000,
   0x0c650000,
   0x80000000,
   0x00008012,
   0x091e0000,
   0x03500594,
   0x00000000,
   0x00c27c20,
   0x00130000,
   0x005a3434,
   0xfe6b2840,
   0xdeade8ca,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x07d00011,
   0x6fdd2fea,
   0x0fb00ff0,
   0xf80f0003,
   0x007f7f30,
   0x7f7f001f,
   0x8010005a,
   0x01900000,
   0x40000800,
   0xc1020c65,
   0xc0013162,
   0x1e008150,
   0x1a10404d,
   0x1020604f,
   0x6f131a10,
   0x16116e23,
   0x684f1612,
   0xc0307000,
   0x722067b5,
   0xa32d7248,
   0x73057303,
   0x73047203,
   0x72047306,
   0x72767376,
   0x8001c7c0,
   0x90010001,
   0x08019010,
   0x720c9001,
   0x720e720d,
   0x7100b0c0,
   0xb0f0a0c0,
   0x81327218,
   0x39521020,
   0x00200670,
   0x11011630,
   0x6c011401,
   0x6098608a,
   0x616660ba,
   0x608a6205,
   0x608a608a,
   0x6098608a,
   0x616660ba,
   0x608a6205,
   0x608a608a,
   0x67b5c040,
   0xc0506092,
   0x609067b5,
   0x60931220,
   0x81811210,
   0x91800010,
   0x606cb070,
   0xc282c011,
   0x1820c560,
   0x6e236f13,
   0x16121611,
   0x7c10689c,
   0xc02297e0,
   0x39818131,
   0xd0601812,
   0x67b59862,
   0x97c07be0,
   0x40921e01,
   0x97c07bb0,
   0x97e07c20,
   0x93507bf0,
   0x93007c00,
   0x92d07c30,
   0x6092b330,
   0xc070674e,
   0xb5a091c0,
   0xb76466e1,
   0x66feb203,
   0x8724a5a0,
   0x87349454,
   0x8ad49464,
   0x86149434,
   0x8ab09444,
   0x40d02200,
   0xb110b0e0,
   0xb0c5b0c0,
   0xb0f0b116,
   0x2a007b50,
   0xc0f19060,
   0x40db1e0e,
   0x97811611,
   0xc037b762,
   0xa760b041,
   0xb116b0e6,
   0xb0f57311,
   0xa760c031,
   0xb0737100,
   0xb88eb760,
   0x22008090,
   0x80b2455b,
   0x44fd2262,
   0x40e32250,
   0x22008210,
   0x220f44fa,
   0x100f40e3,
   0x60e3676e,
   0x6784100f,
   0xa76360e3,
   0xb889b204,
   0xa0c5936c,
   0xb0c1720e,
   0x7100b0f1,
   0xb0f19787,
   0xb32d7100,
   0x9780c3f0,
   0xc0d0b074,
   0x879193b0,
   0x678f95e1,
   0x14018791,
   0x7100b0f1,
   0xb88ab88b,
   0xc210b078,
   0xa2029780,
   0xb0f1b205,
   0xa32d7100,
   0x7276b06e,
   0x8942a0c1,
   0x3d823182,
   0x67b5c070,
   0x8a828a63,
   0x8a741423,
   0x14248a92,
   0x06f28982,
   0x31418971,
   0x95f20012,
   0x0424cff2,
   0x31433143,
   0x96040034,
   0x693bc8f0,
   0xb110b205,
   0xb116a0e0,
   0xb764a0e6,
   0xa5a07276,
   0xa002a003,
   0x9010c7c0,
   0x72047203,
   0x73067305,
   0x720c720e,
   0x7311720d,
   0x730f7310,
   0xb205a202,
   0x1e028212,
   0x72204552,
   0x67b5c080,
   0xb2056092,
   0x8792a202,
   0x9862d090,
   0x720e67b5,
   0x7311720c,
   0x613d730f,
   0x674ec00f,
   0x91c0c070,
   0xc0a066e1,
   0xb01367b5,
   0x8ab0b064,
   0x41742200,
   0xb110b0e0,
   0xb0c0b0e6,
   0xb0f1b0c5,
   0x7276b116,
   0xc0e1b762,
   0x417f1e0e,
   0x97811611,
   0xb041c037,
   0xc031b202,
   0xb0f5a760,
   0xb0737100,
   0xb88eb760,
   0x22008090,
   0x80b245fc,
   0x459d2262,
   0x41832250,
   0x22008210,
   0x220f459a,
   0x100f4183,
   0x6183676e,
   0x6784100f,
   0xb7636183,
   0xb889b204,
   0xa0c5936c,
   0x8180720e,
   0x91802640,
   0xb0f1b0c1,
   0xb0417100,
   0xb0f19787,
   0xb32d7100,
   0x9780c3f0,
   0xc0d0b074,
   0xb0f193b0,
   0xb0787100,
   0x9780c210,
   0xb0f1a202,
   0xa32d7100,
   0xa760b06e,
   0x678fa0c1,
   0x140187e1,
   0x14018170,
   0xb0f69781,
   0x7100b0c6,
   0xa0c6b0f6,
   0x22008090,
   0xb01245fc,
   0x94548724,
   0x94648734,
   0x94348ad4,
   0x94448614,
   0x82007276,
   0x26302a20,
   0x66fe9200,
   0x8601c070,
   0x31828942,
   0xc3103d82,
   0xb06469e2,
   0x730fb0f1,
   0x73117310,
   0x720c720e,
   0xb205720d,
   0x1e028212,
   0xb76445e5,
   0xa0037276,
   0xc7c0a002,
   0x72039010,
   0x73057204,
   0xc0b07306,
   0x609267b5,
   0x67b5c0c0,
   0x720eb205,
   0x7311720c,
   0x7276730f,
   0x674e61e5,
   0xc070c00b,
   0x66e191c0,
   0x67b5c0d0,
   0x725fb764,
   0xb0137223,
   0x22008ab0,
   0xb0e04216,
   0x6216b110,
   0xb064b0f0,
   0xb0c5b0c0,
   0xb041b061,
   0x42211e1b,
   0xb7627276,
   0xc0b772ac,
   0x1e0ec070,
   0x16104227,
   0x9780c0b7,
   0xb0f5b202,
   0xa0e0b110,
   0xb0e6a760,
   0xc031b116,
   0x7100a760,
   0xb760b073,
   0x8090b88e,
   0x46d62200,
   0x226280b2,
   0x22504648,
   0x8210422f,
   0x46452200,
   0x422f220f,
   0x676e100f,
   0x100f622f,
   0x60e36784,
   0x1e1bb204,
   0xa7654263,
   0xb763b766,
   0x8983b88b,
   0x897406f3,
   0x00433144,
   0x8a6395f3,
   0x14038a80,
   0x8a748a90,
   0x31431404,
   0x00343143,
   0x81809604,
   0x91802650,
   0xa763629d,
   0x26408180,
   0x97879180,
   0x936cb889,
   0x720ea0c5,
   0xb0f1b0c1,
   0x7100b0f1,
   0xc3e0b32d,
   0xb0749780,
   0x93b0c0d0,
   0x95e18791,
   0xb0f1678f,
   0xb0787100,
   0x9780c210,
   0xb205a202,
   0x7100b0f1,
   0xb06ea32d,
   0xa0c17276,
   0x31828942,
   0xb88b3d82,
   0x06f38983,
   0x31448974,
   0x92330043,
   0x8a808a63,
   0x8a901403,
   0x14048a74,
   0x31433143,
   0x96040034,
   0x6a9bc8f0,
   0xbac062b7,
   0x94548724,
   0x94648734,
   0x94348ad4,
   0x94448614,
   0xb0f0c01b,
   0xa202b064,
   0x22628212,
   0x722042a9,
   0xb0f5b064,
   0xb116b110,
   0xc410b202,
   0x676e6ab4,
   0xb2056229,
   0xa0e0b110,
   0xa0e6b116,
   0x7276b764,
   0xa003a5a0,
   0xc7c0a002,
   0x72039010,
   0x73057204,
   0x720e7306,
   0x720c720d,
   0x720d720e,
   0xa202730f,
   0x8212b205,
   0x46c71e02,
   0xc0e07220,
   0x609267b5,
   0xa202b205,
   0xd0f08792,
   0x67b59862,
   0x720c720e,
   0x730f7311,
   0x821262b8,
   0x42e12212,
   0xb016b006,
   0xb002b012,
   0xb014b004,
   0x90307b40,
   0x7b509050,
   0x90609040,
   0x7310730f,
   0xb1077311,
   0x7100b0d7,
   0xa0d7b072,
   0x6af9d680,
   0xc090676e,
   0x700093b0,
   0xc040bac0,
   0xb7619780,
   0xb0c1b760,
   0x7100b0f1,
   0xa0c17276,
   0x7b37b0f1,
   0x94857229,
   0xc0f38ab2,
   0xb013b003,
   0x92908140,
   0x94908160,
   0xb100b0d0,
   0x22027100,
   0x84504722,
   0x92939490,
   0x7100b100,
   0x94908460,
   0x7100b100,
   0x94908430,
   0xb1009293,
   0x84407100,
   0xb1009490,
   0x8ae07100,
   0xb1009490,
   0x94867100,
   0x9780c040,
   0xb760b761,
   0xb0f1b0c1,
   0xb100a0d0,
   0x72767100,
   0xb0f1a0c1,
   0x1e1085a0,
   0xb2054341,
   0xa7656348,
   0xb763b766,
   0x2a308200,
   0x92002620,
   0x6b49c090,
   0xc100aac0,
   0x700067b5,
   0x72187220,
   0x9290c0f0,
   0xc1f1722c,
   0xc01592a1,
   0x7b377b26,
   0x8ab07b6c,
   0x43612200,
   0x94007b90,
   0x94207bb0,
   0x7bc06363,
   0xaac09400,
   0xc1009486,
   0x813e91b0,
   0xc01d398e,
   0x436d1e0e,
   0x7000c03d,
   0x724f724e,
   0xb0537b82,
   0xc3b09362,
   0x73886b74,
   0x94e08890,
   0x94f188a1,
   0x7b709366,
   0x88939360,
   0x313388a4,
   0x31343d33,
   0x70003d34,
   0x88939881,
   0x313388a4,
   0x31343d63,
   0x94e33d64,
   0xb05394f4,
   0x1e0e7000,
   0x8a6143a6,
   0x18108a70,
   0xc0024fa0,
   0x161110d1,
   0x16201812,
   0x1c203d20,
   0x10204fb4,
   0x63b41610,
   0x3d201620,
   0x4bb41cd0,
   0x63b410d0,
   0xc082c000,
   0x8a748a63,
   0x1c241834,
   0x14424fb0,
   0x63b44bb2,
   0x63b410d0,
   0x18d0c000,
   0x98507000,
   0x22008840,
   0xb83047b6,
   0x00007000
};

PATCH_FUN_SPEC void rf_patch_mce_tof(void)
{
#ifdef __PATCH_NO_UNROLLING
   uint32_t i;
   for (i = 0; i < 478; i++) {
      HWREG(RFC_MCERAM_BASE + 4 * i) = patchTofMce[i];
   }
#else
   const uint32_t *pS = patchTofMce;
   volatile unsigned long *pD = &HWREG(RFC_MCERAM_BASE);
   uint32_t t1, t2, t3, t4, t5, t6, t7, t8;
   uint32_t nIterations = 59;

   do {
      t1 = *pS++;
      t2 = *pS++;
      t3 = *pS++;
      t4 = *pS++;
      t5 = *pS++;
      t6 = *pS++;
      t7 = *pS++;
      t8 = *pS++;
      *pD++ = t1;
      *pD++ = t2;
      *pD++ = t3;
      *pD++ = t4;
      *pD++ = t5;
      *pD++ = t6;
      *pD++ = t7;
      *pD++ = t8;
   } while (--nIterations);

   t1 = *pS++;
   t2 = *pS++;
   t3 = *pS++;
   t4 = *pS++;
   t5 = *pS++;
   t6 = *pS++;
   *pD++ = t1;
   *pD++ = t2;
   *pD++ = t3;
   *pD++ = t4;
   *pD++ = t5;
   *pD++ = t6;
#endif
}

#endif
